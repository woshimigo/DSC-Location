<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>卫星定位系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #4fc3f7;
            text-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #bbdefb;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .satellite-icons {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .satellite {
            text-align: center;
            background: rgba(0, 30, 60, 0.5);
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }
        
        .satellite:hover {
            transform: translateY(-5px);
            background: rgba(0, 50, 100, 0.6);
        }
        
        .satellite i {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #4fc3f7;
        }
        
        .satellite h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .panel {
            flex: 1;
            min-width: 300px;
            background: rgba(13, 38, 59, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
        }
        
        .panel-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #81d4fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            color: #4fc3f7;
        }
        
        .location-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .data-item {
            background: rgba(0, 50, 100, 0.4);
            padding: 15px;
            border-radius: 10px;
        }
        
        .data-label {
            font-size: 0.9rem;
            color: #bbdefb;
            margin-bottom: 5px;
        }
        
        .data-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #4fc3f7;
        }
        
        .compass-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 300px;
            position: relative;
        }
        
        .compass {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: rgba(0, 30, 60, 0.7);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
            border: 3px solid rgba(79, 195, 247, 0.3);
        }
        
        .compass-inner {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: rgba(13, 38, 59, 0.9);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .compass-arrow {
            width: 10px;
            height: 100px;
            background: #e53935;
            position: absolute;
            top: 10px;
            border-radius: 5px;
            transform-origin: bottom center;
            box-shadow: 0 0 10px rgba(229, 57, 53, 0.7);
            z-index: 10;
        }
        
        .compass-n {
            position: absolute;
            top: 15px;
            font-weight: bold;
            color: #e53935;
            font-size: 1.2rem;
        }
        
        .compass-e {
            position: absolute;
            right: 15px;
            font-weight: bold;
        }
        
        .compass-s {
            position: absolute;
            bottom: 15px;
            font-weight: bold;
        }
        
        .compass-w {
            position: absolute;
            left: 15px;
            font-weight: bold;
        }
        
        .directions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            width: 100%;
        }
        
        .direction {
            background: rgba(0, 50, 100, 0.4);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 100px;
        }
        
        .direction-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #4fc3f7;
        }
        
        .map-container {
            height: 300px;
            background: rgba(0, 30, 60, 0.5);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        #map {
            height: 100%;
            width: 100%;
        }
        
        .map-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            flex-direction: column;
            color: #bbdefb;
            background: rgba(0, 30, 60, 0.5);
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
        }
        
        .map-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: rgba(79, 195, 247, 0.5);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            background: linear-gradient(45deg, #1976d2, #4fc3f7);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(25, 118, 210, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(25, 118, 210, 0.6);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-alt {
            background: linear-gradient(45deg, #388e3c, #81c784);
        }
        
        .btn-alt:hover {
            box-shadow: 0 8px 20px rgba(56, 142, 60, 0.6);
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #d32f2f, #f44336);
        }
        
        .btn-warning:hover {
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.6);
        }
        
        .status {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .status.active {
            background: rgba(56, 142, 60, 0.3);
            color: #a5d6a7;
        }
        
        .status.warning {
            background: rgba(211, 47, 47, 0.3);
            color: #ffcdd2;
        }
        
        .status i {
            margin-right: 10px;
        }
        
        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #bbdefb;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .satellite-icons {
                gap: 15px;
            }
            
            .satellite {
                padding: 10px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        .signal-strength {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .signal-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .signal-bars {
            display: flex;
            gap: 3px;
            align-items: flex-end;
            height: 30px;
        }
        
        .signal-bar {
            width: 8px;
            background: #4fc3f7;
            border-radius: 2px 2px 0 0;
        }
        
        .signal-bar:nth-child(1) { height: 6px; }
        .signal-bar:nth-child(2) { height: 12px; }
        .signal-bar:nth-child(3) { height: 18px; }
        .signal-bar:nth-child(4) { height: 24px; }
        .signal-bar:nth-child(5) { height: 30px; }
        
        .signal-name {
            min-width: 80px;
        }
        
        .active .signal-bar {
            background: #81c784;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .sos-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(211, 47, 47, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: sosPulse 1s infinite;
        }
        
        @keyframes sosPulse {
            0% { background: rgba(211, 47, 47, 0.9); }
            50% { background: rgba(244, 67, 54, 0.7); }
            100% { background: rgba(211, 47, 47, 0.9); }
        }
        
        .sos-text {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            animation: blink 0.5s infinite;
        }
        
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .sos-coordinates {
            font-size: 1.5rem;
            margin-bottom: 30px;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 10px;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-satellite"></i> 卫星定位系统</h1>
            <p class="subtitle">本系统支持GPS、格洛纳斯、伽利略和北斗卫星系统进行精确定位，结合手机内置指南针功能，为您在野外提供可靠的位置与方向信息，保障您的安全。</p>
        </header>
        
        <div class="satellite-icons">
            <div class="satellite">
                <i class="fas fa-satellite pulse"></i>
                <h3>GPS</h3>
                <p>美国全球定位系统</p>
            </div>
            <div class="satellite">
                <i class="fas fa-satellite pulse"></i>
                <h3>格洛纳斯</h3>
                <p>俄罗斯卫星系统</p>
            </div>
            <div class="satellite">
                <i class="fas fa-satellite pulse"></i>
                <h3>伽利略</h3>
                <p>欧洲卫星系统</p>
            </div>
            <div class="satellite">
                <i class="fas fa-satellite pulse"></i>
                <h3>北斗</h3>
                <p>中国卫星导航系统</p>
            </div>
        </div>
        
        <div class="content">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-map-marker-alt"></i> 当前位置信息</h2>
                <div class="location-data">
                    <div class="data-item">
                        <div class="data-label">纬度</div>
                        <div class="data-value" id="latitude">--</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">经度</div>
                        <div class="data-value" id="longitude">--</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">海拔</div>
                        <div class="data-value" id="altitude">--</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">精度</div>
                        <div class="data-value" id="accuracy">--</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">速度</div>
                        <div class="data-value" id="speed">--</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">时间</div>
                        <div class="data-value" id="timestamp">--</div>
                    </div>
                </div>
                
                <h3 style="margin-top: 25px; color: #81d4fa;">卫星信号强度</h3>
                <div class="signal-strength">
                    <div class="signal-item" id="gps-signal">
                        <div class="signal-name">GPS</div>
                        <div class="signal-bars">
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                        </div>
                    </div>
                    <div class="signal-item" id="glonass-signal">
                        <div class="signal-name">格洛纳斯</div>
                        <div class="signal-bars">
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                        </div>
                    </div>
                    <div class="signal-item" id="galileo-signal">
                        <div class="signal-name">伽利略</div>
                        <div class="signal-bars">
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar" style="background: #546e7a"></div>
                        </div>
                    </div>
                    <div class="signal-item" id="beidou-signal">
                        <div class="signal-name">北斗</div>
                        <div class="signal-bars">
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                            <div class="signal-bar"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-compass"></i> 指南针</h2>
                <div class="compass-container">
                    <div class="compass">
                        <div class="compass-inner">
                            <div class="compass-arrow" id="compass-arrow"></div>
                            <div class="compass-n">N</div>
                            <div class="compass-e">E</div>
                            <div class="compass-s">S</div>
                            <div class="compass-w">W</div>
                        </div>
                    </div>
                    
                    <div class="directions">
                        <div class="direction">
                            <div class="data-label">方向</div>
                            <div class="direction-value" id="direction">0°</div>
                        </div>
                        <div class="direction">
                            <div class="data-label">朝向</div>
                            <div class="direction-value" id="heading">北</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="panel">
            <h2 class="panel-title"><i class="fas fa-map"></i> 位置地图</h2>
            <div class="map-container">
                <div id="map"></div>
                <div class="map-placeholder" id="map-placeholder">
                    <i class="fas fa-globe-americas"></i>
                    <p>地图功能将在定位后显示您的位置</p>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" id="locate-btn">
                <i class="fas fa-location-dot"></i> 获取当前位置
            </button>
            <button class="btn btn-alt" id="compass-btn">
                <i class="fas fa-compass"></i> 启动指南针
            </button>
            <button class="btn btn-warning" id="sos-btn">
                <i class="fas fa-circle-exclamation"></i> 发送SOS求救信号
            </button>
        </div>
        
        <div class="status warning" id="status">
            <i class="fas fa-info-circle"></i> 系统状态：等待定位中... 请点击"获取当前位置"按钮
        </div>
        
        <footer>
            <p>卫星定位系统 | 为您的户外探险提供安全保障 | 技术支持：多卫星融合定位技术</p>
            <p>注意：使用时请确保定期检查卫星信号状态</p>
        </footer>
    </div>
    
    <div class="sos-overlay hidden" id="sos-overlay">
        <div class="sos-text">进入SOS模式，赶快截图给你的家人让他们来救你！</div>
        <div class="sos-coordinates" id="sos-coordinates">坐标：--</div>
        <button class="btn" id="cancel-sos-btn">
            <i class="fas fa-times"></i> 取消求救
        </button>
    </div>

    <!-- 引入Leaflet地图库 -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // 获取DOM元素
        const latitudeEl = document.getElementById('latitude');
        const longitudeEl = document.getElementById('longitude');
        const altitudeEl = document.getElementById('altitude');
        const accuracyEl = document.getElementById('accuracy');
        const speedEl = document.getElementById('speed');
        const timestampEl = document.getElementById('timestamp');
        const directionEl = document.getElementById('direction');
        const headingEl = document.getElementById('heading');
        const compassArrow = document.getElementById('compass-arrow');
        const locateBtn = document.getElementById('locate-btn');
        const compassBtn = document.getElementById('compass-btn');
        const sosBtn = document.getElementById('sos-btn');
        const cancelSosBtn = document.getElementById('cancel-sos-btn');
        const statusEl = document.getElementById('status');
        const sosOverlay = document.getElementById('sos-overlay');
        const sosCoordinates = document.getElementById('sos-coordinates');
        const mapPlaceholder = document.getElementById('map-placeholder');
        
        // 地图相关变量
        let map = null;
        let marker = null;
        let compassActive = false;
        let watchId = null;
        let currentCoords = null;
        
        // 初始化定位功能
        function initGeolocation() {
            if (!navigator.geolocation) {
                statusEl.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 您的浏览器不支持地理定位功能';
                statusEl.className = 'status warning';
                locateBtn.disabled = true;
                return;
            }
            
            // 尝试获取当前位置
            navigator.geolocation.getCurrentPosition(
                position => updatePosition(position),
                error => handleGeolocationError(error)
            );
            
            // 监听位置变化
            watchId = navigator.geolocation.watchPosition(
                position => updatePosition(position),
                error => handleGeolocationError(error),
                {
                    enableHighAccuracy: true,
                    maximumAge: 30000,
                    timeout: 27000
                }
            );
        }
        
        // 更新位置信息
        function updatePosition(position) {
            const coords = position.coords;
            currentCoords = coords;
            
            // 更新位置信息显示
            latitudeEl.textContent = coords.latitude.toFixed(6) + '°';
            longitudeEl.textContent = coords.longitude.toFixed(6) + '°';
            altitudeEl.textContent = coords.altitude ? coords.altitude.toFixed(1) + ' m' : '不可用';
            accuracyEl.textContent = '±' + coords.accuracy.toFixed(1) + ' m';
            speedEl.textContent = coords.speed ? (coords.speed * 3.6).toFixed(1) + ' km/h' : '0 km/h';
            
            const timestamp = new Date(position.timestamp);
            timestampEl.textContent = timestamp.toLocaleTimeString();
            
            // 更新地图
            updateMap(coords.latitude, coords.longitude);
            
            // 更新状态
            statusEl.innerHTML = '<i class="fas fa-circle-check"></i> 定位成功 | 精度：±' + coords.accuracy.toFixed(1) + '米';
            statusEl.className = 'status active';
            
            // 更新卫星信号强度（模拟）
            updateSatelliteSignals();
        }
        
        // 处理定位错误
        function handleGeolocationError(error) {
            let errorMessage = '';
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage = '用户拒绝了定位请求。请允许浏览器访问您的位置';
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMessage = '无法获取位置信息。请检查您的设备设置';
                    break;
                case error.TIMEOUT:
                    errorMessage = '获取位置信息超时。请重试';
                    break;
                default:
                    errorMessage = '发生未知错误';
            }
            
            statusEl.innerHTML = '<i class="fas fa-exclamation-triangle"></i> ' + errorMessage;
            statusEl.className = 'status warning';
        }
        
        // 初始化指南针功能
        function initCompass() {
            if (!window.DeviceOrientationEvent) {
                statusEl.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 您的设备不支持指南针功能';
                statusEl.className = 'status warning';
                compassBtn.disabled = true;
                return;
            }
            
            // 请求设备方向权限
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation);
                            compassActive = true;
                            compassBtn.innerHTML = '<i class="fas fa-compass"></i> 停止指南针';
                            compassBtn.style.background = 'linear-gradient(45deg, #f57c00, #ffb74d)';
                        } else {
                            statusEl.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 用户拒绝了指南针访问权限';
                            statusEl.className = 'status warning';
                        }
                    })
                    .catch(console.error);
            } else {
                window.addEventListener('deviceorientation', handleOrientation);
                compassActive = true;
                compassBtn.innerHTML = '<i class="fas fa-compass"></i> 停止指南针';
                compassBtn.style.background = 'linear-gradient(45deg, #f57c00, #ffb74d)';
            }
        }
        
        // 处理设备方向事件
        function handleOrientation(event) {
            const alpha = event.alpha; // 设备绕Z轴的旋转角度（0-360）
            
            if (alpha !== null) {
                // 旋转指南针箭头
                compassArrow.style.transform = `rotate(${360 - alpha}deg)`;
                
                // 更新方向显示
                directionEl.textContent = Math.round(alpha) + '°';
                
                // 确定基本方向
                let headingText;
                if (alpha >= 338 || alpha < 23) headingText = "北";
                else if (alpha >= 23 && alpha < 68) headingText = "东北";
                else if (alpha >= 68 && alpha < 113) headingText = "东";
                else if (alpha >= 113 && alpha < 158) headingText = "东南";
                else if (alpha >= 158 && alpha < 203) headingText = "南";
                else if (alpha >= 203 && alpha < 248) headingText = "西南";
                else if (alpha >= 248 && alpha < 293) headingText = "西";
                else headingText = "西北";
                
                headingEl.textContent = headingText;
            }
        }
        
        // 更新卫星信号强度（模拟）
        function updateSatelliteSignals() {
            const signals = ['gps-signal', 'glonass-signal', 'galileo-signal', 'beidou-signal'];
            
            signals.forEach(signalId => {
                const signalEl = document.getElementById(signalId);
                const bars = signalEl.querySelectorAll('.signal-bar');
                
                // 随机信号强度（模拟）
                const strength = Math.floor(Math.random() * 5) + 1;
                
                bars.forEach((bar, index) => {
                    if (index < strength) {
                        bar.style.background = '#81c784'; // 强信号
                    } else {
                        bar.style.background = '#546e7a'; // 弱信号
                    }
                });
                
                signalEl.className = strength > 2 ? 'signal-item active' : 'signal-item';
            });
        }
        
        // 初始化地图
        function initMap() {
            map = L.map('map', {
                zoomControl: false,
                attributionControl: false
            });
            
            // 添加OpenStreetMap图层
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19
            }).addTo(map);
            
            // 初始位置设为北京
            map.setView([39.9042, 116.4074], 5);
        }
        
        // 更新地图位置
        function updateMap(lat, lng) {
            if (!map) return;
            
            // 移除地图占位符
            mapPlaceholder.classList.add('hidden');
            
            // 设置地图中心
            map.setView([lat, lng], 16);
            
            // 添加或更新标记
            if (!marker) {
                marker = L.marker([lat, lng]).addTo(map);
                marker.bindPopup('您的位置').openPopup();
            } else {
                marker.setLatLng([lat, lng]);
            }
        }
        
        // SOS功能
        function sendSOS() {
            if (!currentCoords) {
                alert('请先获取当前位置');
                return;
            }
            
            sosOverlay.classList.remove('hidden');
            sosCoordinates.textContent = `坐标：${currentCoords.latitude.toFixed(6)}, ${currentCoords.longitude.toFixed(6)}`;
            
            // 模拟发送SOS信号
            setTimeout(() => {
                statusEl.innerHTML = '<i class="fas fa-check-circle"></i> SOS求救信号已发送！救援中心已收到您的位置信息';
                statusEl.className = 'status active';
            }, 2000);
        }
        
        // 事件监听
        locateBtn.addEventListener('click', initGeolocation);
        
        compassBtn.addEventListener('click', () => {
            if (compassActive) {
                window.removeEventListener('deviceorientation', handleOrientation);
                compassActive = false;
                compassBtn.innerHTML = '<i class="fas fa-compass"></i> 启动指南针';
                compassBtn.style.background = 'linear-gradient(45deg, #388e3c, #81c784)';
            } else {
                initCompass();
            }
        });
        
        sosBtn.addEventListener('click', sendSOS);
        
        cancelSosBtn.addEventListener('click', () => {
            sosOverlay.classList.add('hidden');
            statusEl.innerHTML = '<i class="fas fa-info-circle"></i> SOS求救已取消';
            statusEl.className = 'status';
        });
        
        // 页面加载时初始化地图
        window.onload = function() {
            initMap();
            
            // 初始卫星信号
            updateSatelliteSignals();
        }
    </script>
</body>
</html>